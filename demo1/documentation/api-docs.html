<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Walk Suitability API - API Documentation</title>
    <link rel="stylesheet" href="https://unpkg.com/swagger-ui-dist@5.10.0/swagger-ui.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 700;
        }

        .header p {
            margin: 0.5rem 0 0 0;
            font-size: 1.1rem;
            opacity: 0.95;
        }

        .info-section {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 2rem;
        }

        .info-card {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .info-card h2 {
            color: #667eea;
            margin-top: 0;
            font-size: 1.5rem;
        }

        .info-card ul {
            line-height: 1.8;
        }

        .api-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .api-item {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 6px;
            border-left: 4px solid #667eea;
        }

        .api-item h3 {
            margin: 0 0 0.5rem 0;
            color: #333;
            font-size: 1.1rem;
        }

        .api-item p {
            margin: 0;
            color: #666;
            font-size: 0.9rem;
        }

        .swagger-container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem 2rem 2rem;
        }

        #swagger-ui {
            border-radius: 8px;
            overflow: hidden;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .feature-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
        }

        .feature-box h3 {
            margin: 0 0 0.5rem 0;
            font-size: 2rem;
        }

        .feature-box p {
            margin: 0;
            opacity: 0.9;
        }

        .alert {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            border-radius: 4px;
            padding: 1rem;
            margin: 1rem 0;
            color: #0c5460;
        }
    </style>
</head>
<body>

    <div class="swagger-container">
        <div id="swagger-ui"></div>
    </div>

    <script src="https://unpkg.com/swagger-ui-dist@5.10.0/swagger-ui-bundle.js"></script>
    <script src="https://unpkg.com/swagger-ui-dist@5.10.0/swagger-ui-standalone-preset.js"></script>
    <script>
        // OpenAPI 仕様のインライン版（CORS問題を回避）
        const spec = {
  "openapi": "3.0.3",
  "info": {
    "title": "Walk Suitability API",
    "description": "散歩適合度指数API - 天気と大気質データを統合し、ユーザーに科学的な散歩アドバイスを提供します\n\n本サービスは以下の2つの公開APIを呼び出します：\n- OpenWeatherMap API (天気データ)\n- World Air Quality Index API (大気質データ)\n\nこれらのデータを融合して総合的な「散歩適合度指数」(0-100点)を算出します。\n",
    "version": "1.0.0",
    "contact": {
      "name": "API Support",
      "email": "support@walksuitability.com"
    }
  },
  "servers": [
    {
      "url": "http://localhost:5000",
      "description": "ローカル開発サーバー"
    }
  ],
  "tags": [
    {
      "name": "Walk Suitability",
      "description": "散歩適合度関連インターフェース"
    },
    {
      "name": "Weather",
      "description": "天気データインターフェース"
    },
    {
      "name": "Air Quality",
      "description": "大気質データインターフェース"
    },
    {
      "name": "System",
      "description": "システムインターフェース"
    }
  ],
  "paths": {
    "/": {
      "get": {
        "tags": ["System"],
        "summary": "API情報",
        "description": "APIの基本情報と利用可能なエンドポイントを取得",
        "responses": {
          "200": {
            "description": "API情報を正常に返却",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "service": {
                      "type": "string",
                      "example": "Walk Suitability API"
                    },
                    "version": {
                      "type": "string",
                      "example": "1.0.0"
                    },
                    "description": {
                      "type": "string"
                    },
                    "endpoints": {
                      "type": "object"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/health": {
      "get": {
        "tags": ["System"],
        "summary": "ヘルスチェック",
        "description": "APIサービスが正常に動作しているか確認",
        "responses": {
          "200": {
            "description": "サービス正常",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "healthy"
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/walk-suitability": {
      "get": {
        "tags": ["Walk Suitability"],
        "summary": "散歩適合度指数を取得",
        "description": "指定された都市の天気と大気質データに基づいて、散歩適合度指数を計算して返却します。\n\n評価基準：\n- 80-100点：散歩に非常に適している\n- 60-79点：散歩に適している\n- 40-59点：普通\n- 0-39点：散歩に適していない\n\n計算要素：\n- 気温 (重み: 25%)\n- 天候状況 (重み: 25%)\n- 大気質 (重み: 30%)\n- 湿度 (重み: 10%)\n- 風速 (重み: 10%)\n",
        "parameters": [
          {
            "name": "city",
            "in": "query",
            "description": "都市名（英語）",
            "required": false,
            "schema": {
              "type": "string",
              "default": "Tokyo",
              "example": "Tokyo"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "散歩適合度データを正常に返却",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "city": {
                      "type": "string",
                      "example": "Tokyo"
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "suitability": {
                      "type": "object",
                      "properties": {
                        "score": {
                          "type": "number",
                          "format": "float",
                          "description": "散歩適合度指数 (0-100)",
                          "example": 85.5
                        },
                        "level": {
                          "type": "string",
                          "description": "適合度レベル",
                          "enum": ["非常に適している", "適している", "普通", "適していない"],
                          "example": "非常に適している"
                        },
                        "recommendation": {
                          "type": "string",
                          "description": "散歩アドバイス",
                          "example": "今は散歩に最適な時間です！"
                        },
                        "reasons": {
                          "type": "array",
                          "items": {
                            "type": "string"
                          },
                          "description": "評価理由の説明",
                          "example": ["天気と大気質ともに良好です"]
                        },
                        "details": {
                          "type": "object",
                          "properties": {
                            "temperature_score": {
                              "type": "number",
                              "example": 100.0
                            },
                            "weather_score": {
                              "type": "number",
                              "example": 100.0
                            },
                            "humidity_score": {
                              "type": "number",
                              "example": 80.0
                            },
                            "wind_score": {
                              "type": "number",
                              "example": 100.0
                            },
                            "aqi_score": {
                              "type": "number",
                              "example": 80.0
                            }
                          }
                        }
                      }
                    },
                    "weather": {
                      "$ref": "#/components/schemas/WeatherData"
                    },
                    "air_quality": {
                      "$ref": "#/components/schemas/AirQualityData"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "サーバーエラー",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/api/weather": {
      "get": {
        "tags": ["Weather"],
        "summary": "天気データを取得",
        "description": "OpenWeatherMap APIから指定都市の天気情報を取得",
        "parameters": [
          {
            "name": "city",
            "in": "query",
            "description": "都市名（英語）",
            "required": false,
            "schema": {
              "type": "string",
              "default": "Tokyo",
              "example": "Tokyo"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "天気データを正常に返却",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "city": {
                      "type": "string",
                      "example": "Tokyo"
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "data": {
                      "$ref": "#/components/schemas/WeatherData"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "サーバーエラー",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/api/air-quality": {
      "get": {
        "tags": ["Air Quality"],
        "summary": "大気質データを取得",
        "description": "World Air Quality Index APIから指定都市の大気質情報を取得",
        "parameters": [
          {
            "name": "city",
            "in": "query",
            "description": "都市名（英語）",
            "required": false,
            "schema": {
              "type": "string",
              "default": "Tokyo",
              "example": "Tokyo"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "大気質データを正常に返却",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "city": {
                      "type": "string",
                      "example": "Tokyo"
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "data": {
                      "$ref": "#/components/schemas/AirQualityData"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "サーバーエラー",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "WeatherData": {
        "type": "object",
        "description": "天気データオブジェクト",
        "properties": {
          "temperature": {
            "type": "number",
            "format": "float",
            "description": "気温（摂氏）",
            "example": 22.5
          },
          "feels_like": {
            "type": "number",
            "format": "float",
            "description": "体感気温（摂氏）",
            "example": 21.8
          },
          "humidity": {
            "type": "integer",
            "description": "湿度（パーセント）",
            "example": 65
          },
          "weather": {
            "type": "string",
            "description": "天候状況",
            "example": "Clear"
          },
          "weather_description": {
            "type": "string",
            "description": "天候の詳細説明",
            "example": "clear sky"
          },
          "wind_speed": {
            "type": "number",
            "format": "float",
            "description": "風速（m/s）",
            "example": 3.5
          },
          "clouds": {
            "type": "integer",
            "description": "雲量（パーセント）",
            "example": 20
          }
        }
      },
      "AirQualityData": {
        "type": "object",
        "description": "大気質データオブジェクト",
        "properties": {
          "aqi": {
            "type": "integer",
            "description": "大気質指数 (AQI)",
            "example": 45
          },
          "pm25": {
            "type": "number",
            "format": "float",
            "description": "PM2.5濃度",
            "nullable": true,
            "example": 12.5
          },
          "pm10": {
            "type": "number",
            "format": "float",
            "description": "PM10濃度",
            "nullable": true,
            "example": 25.3
          },
          "o3": {
            "type": "number",
            "format": "float",
            "description": "オゾン濃度",
            "nullable": true,
            "example": 30.2
          },
          "no2": {
            "type": "number",
            "format": "float",
            "description": "二酸化窒素濃度",
            "nullable": true,
            "example": 15.8
          }
        }
      },
      "Error": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "example": false
          },
          "error": {
            "type": "string",
            "description": "エラーメッセージ",
            "example": "天気データの取得に失敗しました"
          }
        }
      }
    }
  }
};

        window.onload = function() {
            // 使用内联的 OpenAPI 规范
            window.ui = SwaggerUIBundle({
                spec: spec,
                dom_id: '#swagger-ui',
                deepLinking: true,
                presets: [
                    SwaggerUIBundle.presets.apis,
                    SwaggerUIStandalonePreset
                ],
                plugins: [
                    SwaggerUIBundle.plugins.DownloadUrl
                ],
                layout: "StandaloneLayout",
                defaultModelsExpandDepth: 1,
                defaultModelExpandDepth: 1,
                docExpansion: 'list',
                tryItOutEnabled: true,
                displayRequestDuration: true,
                filter: true,
                syntaxHighlight: {
                    activate: true,
                    theme: "monokai"
                }
            });
        };
    </script>
</body>
</html>
